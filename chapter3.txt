and finally chapter 3. More changes